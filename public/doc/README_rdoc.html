<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8">

<title>README - Rails Application Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-Cwock+---+the+time-oriented+microblog"><a href="https://cwock.com">Cwock</a> — the time-oriented microblog</a>
    <li><a href="#label-Intro-Promo">Intro-Promo</a>
    <li><a href="#label-Brief+Walkthrough">Brief Walkthrough</a>
    <li><a href="#label-Take+a+generic+Rails+app...">Take a generic Rails app…</a>
    <li><a href="#label-To+dock+or+not+to+dock-3F">To dock or not to dock?</a>
    <li><a href="#label-...and+dock+it-21">…and dock it!</a>
    <li><a href="#label-Ok-2C+now+what+about+Cwock-3F-3F">Ok, now what about Cwock??</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./README_rdoc.html">README</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.rdoc">

<p>( <strong>code</strong> fresh )</p>

<h1 id="label-Cwock+---+the+time-oriented+microblog"><a href="https://cwock.com">Cwock</a> — the time-oriented microblog<span><a href="#label-Cwock+---+the+time-oriented+microblog">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p><strong>A</strong> <a href="https://codefresh.io">Codefresh</a>
<strong>demo</strong> <strong>/</strong> <strong>Getting</strong>
<strong>Started</strong> <strong>with</strong> <a
href="https://codefresh.io">Codefresh</a> <strong>on</strong> <a
href="http://rubyonrails.org">Rails</a>.</p>

<h2 id="label-Intro-Promo">Intro-Promo<span><a href="#label-Intro-Promo">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>You&#39;re a full-stack developer on Rails. And you&#39;d like setup and
maintenance of your servers to be smooth. As smooth as development in Ruby
is. <a href="https://www.docker.com">Docker-smooth</a>. Plus, you probably
work in a team. We&#39;ve got you. Wrap your stack up, afresh.</p>

<p>In case you&#39;re still wondering, working with containers makes you even
full-stack-er. Now however full-stack you are, setting servers up isn&#39;t
your job, still if DevOps write your <a
href="https://docs.docker.com/engine/reference/builder">Dockerfile</a> for
you, you&#39;re probably doing it wrong.</p>

<p>Codefresh will connect to your repository, build docker images when you
push to branches, run tests in its hosted “on-demand” environments, then —
upon success — upload the images to docker hub, and even launch
pre-configured environments on demand. You and your team will have instant
access to and clear visibility of your running and deployable containers,
at codefresh.io and through webhook-based integrations.</p>

<p>We encourage you to learn more about the Docker container technologies and
<a
href="http://blog.carbonfive.com/2015/03/17/docker-rails-docker-compose-together-in-your-development-workflow/">here’s
a nice article on Ruby on Rails on Docker Compose</a> you may start with.</p>

<h2 id="label-Brief+Walkthrough">Brief Walkthrough<span><a href="#label-Brief+Walkthrough">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p><a href="https://github.com/codefresh-io/cwock">Fork (or clone+push) our
sample app repo</a> if you don&#39;t have a generic Rails app handy</p>
</li><li>
<p>Register with <a href="https://codefresh.io">Codefresh</a> for FREE with
your GitHub or Bitbucket account</p>
</li></ul>

<p>+ Welcome! Feel free to look around and ask questions</p>
<ul><li>
<p>Click on Add Service</p>
</li><li>
<p>Choose your Repository and Branch, click on Next</p>
</li><li>
<p>Choose Rails Dockerfile if you don&#39;t have one in the repo, click on
Next</p>
</li><li>
<p>If you have your Dockerfile in the repo, compare to <a
href="https://github.com/codefresh-io/cwock/blob/master/Dockerfile">our
generic Rails Dockerfile</a>, change the former as appropriate</p>
</li><li>
<p>If you don&#39;t have one in the repo, review the generated Dockerfile,
click on Next</p>
</li><li>
<p>Make sure the (unit) Test script is empty, click on Create</p>
</li><li>
<p>Review the results, click on Close &amp; Build</p>
</li><li>
<p>Click on +&#39;s to see the logs, see that the build succeeds</p>
</li></ul>

<p>+ Hooray! You&#39;ve got your first service automatic image build set up:
whenever you push to the repository, Codefresh will build automatically and
notify on any unfortunate failures</p>
<ul><li>
<p>Click on the cogwheel, review your Settings</p>
</li><li>
<p>Make sure Image Name matches your docker hub username (e.g.
docker_hub_user/repo)</p>
</li><li>
<p>Click on Push to Docker Registry, click on the <a
href="http://hub.docker.com">Docker Hub</a> icon, follow the instructions,
click on Save</p>
</li><li>
<p>Click on Build (click on Launch dropdown if needed)</p>
</li><li>
<p>Click on +&#39;s to see the logs, see that the build succeeds</p>
</li></ul>

<p>+ Hooray! Your image will be pushed to the registry on every successful
build</p>
<ul><li>
<p>Click Compositions, enter &#39;staging&#39; for the Name, click the test
area on the left, paste the following:</p>

<pre>web:
  image: codefresh/cwock:master
  ports:
    - 3000
  links:
    - db
db:
  image: postgres</pre>
</li><li>
<p>Replace &#39;codefresh/cwock:master&#39; with your
docker_hub_user/repo:branch</p>
</li><li>
<p>Review your repo&#39;s `config/database.yml` and make sure the settings
above match `adapter:` and `host:` there (`postgresql` and `db`
respectively)</p>
</li><li>
<p>Click on Save, bookmark the URL, click on Launch</p>
</li><li>
<p>Click on +&#39;s to see the logs, see that the launch succeeds</p>
</li><li>
<p>Click on Open App and see your app running at our crafted URL</p>
</li></ul>

<p>+ Hooray! You have just effortlessly run your first composition, you may
even send someone (QA?) the link to your running staging server</p>
<ul><li>
<p>Go back to Codefresh, click on Services</p>
</li><li>
<p>Click on the cogwheel (Settings) of your app service, click on the
Integration Test</p>
</li><li>
<p>Paste the following (a command to run the specs inside the `web` component
we&#39;ve specified above) docker exec integration_web_1 bash -c “bin/rake
db:test:prepare spec”</p>
</li><li>
<p>Select Run tests with composition, choose Staging, click on Save</p>
</li><li>
<p>Click on Build (click on Launch dropdown if needed)</p>
</li><li>
<p>Click on +&#39;s to see the logs, see that the build succeeds…</p>
</li></ul>

<p>+ Wait! If you cloned our sample repository above, it actually fails, since
we forgot to add the <a
href="https://www.relishapp.com/rspec/rspec-rails/docs">specs</a>
themselves, let&#39;s do just that</p>
<ul><li>
<p>Archive that your-build-failed message from Codefresh (delivered to your
email registered with your GitHub/Bitbucket)</p>
</li><li>
<p>Make sure your local development is set up</p>
</li><li>
<p>Add the gem to your Gemfile group :test, :development do</p>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-string">&#39;rspec-rails&#39;</span>
</pre>

<p>end</p>
</li><li>
<p>Run `bundle`, run `bin/rails generate rspec:install` in your working
directory</p>
</li><li>
<p>Then run `bin/rails generate rspec:model note` and `bin/rails generate
rspec:controller notes`</p>
</li><li>
<p>Write some specs, such as, for controller:</p>

<pre class="ruby"><span class="ruby-constant">RSpec</span>.<span class="ruby-identifier">describe</span> <span class="ruby-constant">NotesController</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">controller</span> <span class="ruby-keyword">do</span>

  <span class="ruby-identifier">render_views</span>

  <span class="ruby-identifier">describe</span> <span class="ruby-string">&#39;GET index&#39;</span> <span class="ruby-keyword">do</span>

    <span class="ruby-identifier">it</span> <span class="ruby-string">&quot;should be OK&quot;</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">get</span> :<span class="ruby-identifier">index</span>
      <span class="ruby-identifier">expect</span>(<span class="ruby-identifier">response</span>).<span class="ruby-identifier">to</span> <span class="ruby-identifier">be_success</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span>
</pre>
</li><li>
<p>Commit, push, wait for that…</p>
</li><li>
<p>…and have Codefresh deliver your-build-successful email to you right away</p>
</li></ul>

<p>+ Hooray! Stretch, your project is set up, now every push to your
repo/branch will trigger a build just like this and you will get a
notification if it fails…</p>

<p>+ …and if it doesn&#39;t fail, you may always go to the URL you bookmarked
above, click on Launch and then, on Open App, to go straight to your
freshly started staging server</p>
<ul><li>
<p>When your code is tested and ready for production, click on Images, see
your successfully built image with the latest commit message</p>
</li><li>
<p>Click up arrow / Promote on that image, enter &#39;production&#39; (the tag
you will use for production-deployed images)</p>
</li><li>
<p>Now go set up your production environment (e.g. with {Docker Cloud}{<a
href="https://cloud.docker.com">cloud.docker.com</a>}) where you can set
deploy and auto-re-deploy processes based on tags</p>
</li></ul>

<p>+ We&#39;re done and we&#39;ve done well, <a
href="mailto:contact@codefresh.io">contact Codefresh</a> if you need help
with anything on the way or just wish to share your experience</p>

<h2 id="label-Take+a+generic+Rails+app...">Take a generic Rails app…<span><a href="#label-Take+a+generic+Rails+app...">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>You&#39;re welcome to clone <a
href="https://github.com/codefresh-io/cwock">github.com/codefresh-io/cwock</a>
(<a href="https://github.com/codefresh-io/cwock">fork it on github</a> or
<a href="https://bitbucket.org/repo/import">import it on BitBucket</a>).</p>

<p>Currently, Codefresh works with either GitHub or Bitbucket, with git being
the supported source control technology, so familiarity with the latter as
well as the repository being hosted at GitHub (or Bitbucket) would be the
only prerequisite to get started.</p>

<p>TBD</p>

<h2 id="label-To+dock+or+not+to+dock-3F">To dock or not to dock?<span><a href="#label-To+dock+or+not+to+dock-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>You can use Codefresh knowing nothing of Docker.</p>

<p>TBD</p>

<h2 id="label-...and+dock+it-21">…and dock it!<span><a href="#label-...and+dock+it-21">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>TBD</p>

<h2 id="label-Ok-2C+now+what+about+Cwock-3F-3F">Ok, now what about Cwock??<span><a href="#label-Ok-2C+now+what+about+Cwock-3F-3F">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>TBD</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

